---
title: "3-2. Complexity Theory (2)"
date: 2024-10-10 00:01:00 +0900
categories: [학부 수업, (3-2) Cryptography]
tags: [cryptography]     # TAG names should always be lowercase
math: true
mermaid: true
---

### [3.7] Unsolvable Problems
---
Halting 문제가 $E$에 있다는 것은 셀 수는 있지만 풀 수는 없다는 것을 의미한다. 그럼 이와 같은 Unsolvable 한 문제들에는 어떤 것이 있을까? 아래 문제와 같이 간단한 문제도 Unsolvable한 문제이다.

> 튜링머신 $M$과 입력 $x$가 있을 때, 어떤 symbol $a$를 테이프에 Write 하는 일이 있는가?

이 문제는 Halting 문제로 Reduce 가능하다. 

####  Basic Problem in Crytography
다시 암호학의 근본적인 문제를 확인해보자.

![cry](assets/img/school_cry/cr1-1.png)

Alice가 Bob에게 어떤 암호 시스템을 이용하여 key를 통해 메시지 $m$을 $c$로 암호화하여 $c$를 보내고자 한다. 이 암호 시스템은 다음 두가지를 보장해야 한다.
- Bob이 암호화된 메시지 $c$를 $m$으로 복호화할 수 있어야 한다.
- 모든 공격하는 사람 (Eve)에 의해 모든 암호화된 메시지 $c$를 $m$으로 복호화하는 것이 불가능하다는 것을 보장해야 한다.

즉, Eve가 복호화하는 것이 불가능해야 하므로 이 문제가 Unsolvable 해야한다. 그러나 Bob도 복호화를 해야 하는데 지금까지 배운 것으로는 Eve가 문제를 못 풀면 Bob도 문제를 못 푼다.

만약 Bob이 어떤 정보 $k$를 더 가지고 풀 수 있는 문제라면 어떨까? 그럼 Eve는 모든 $k$에 대해서 문제를 풀려고 시도해보면 된다. 즉, **어떤 방법을 쓰든 Eve는 시간이 무제한으로 주어지면 암호를 풀 수 있다. 반대로 말하자면 어떤 무제한의 시간을 줘도 안 풀리는 암호 시스템은 존재하지 않는다는 것이다!**

따라서, 이제 시간이 제한된 Complexity Class가 필요하다.

### [3.8] Time-Limited Complexity Classes
---
- $P$: DTM $M$ that solves $L$ works in **Polynomial Time**
- $NP$: NTM $M$ that solves $L$ works in **Polynomial Time**
- $EXP$: DTM $M$ that solves $L$ works in **Exponential Time**
- $NEXP$: NTM $M$ that solves $L$ works in **Exponential Time**

Input의 크기에 따라 걸리는 시간이 $O(n),\ O(n^2),\ O(5n^3),\ O(n^{100})$이면 Polynomial Time이라고 하고, $O(2^n),\ O(3^{n^2}),\ O(5^{n^{100}})$ 등이면 Exponential Time이라고 한다. (로그를 씌웠을 때 Polynomial Time이 되어야 한다.)

> Input의 크기는 비트 수를 의미한다. 예를 들어 $1,000,000$이 소수인지 아닌지를 판단하는 문제라면 이 수는 약 $2^{20}$ 크기이므로 $n = 20$을 의미한다. 
- 만약 판단하는데 걸리는 시간도 $1,000,000$이 걸린다면 $2^{20}$이므로 Polynomial Time이 아니라 Exponential Time이 걸린다고 본다. 
- Polynomial Time이 걸리려면 $20^1,\ 20^2, 20^3$ 정도의 시간이여야 한다.
{: .prompt-warning}

위의 정의에 따라 다음 아래 네가지 관계는 자명하다.
1. $P \subseteq NP$
2. $P \subseteq EXP$
3. $NP \subseteq NEXP$
4. $EXP \subseteq NEXP$

#### Space-Limited Complexity Classes
- $PSPACE$: DTM $M$ that solves $L$ uses **Polynomial Space**
- $NPSPACE$: NTM $M$ that solves $L$ uses **Polynomial Space**
- $EXPSPACE$: DTM $M$ that solves $L$ uses **Exponential Space**

Space는 Head가 건드리는 Cell의 개수를 의미한다.

#### Time and Space are not Independent
- $P \subseteq PSPACE$: TM이 $n^5$ 만큼의 시간이 걸린다면 한 타임당 하나의 셀을 사용하므로 $n^5$개 초과의 셀을 사용할 수는 없다. 따라서 $P$는 $PSPACE$의 부분집합.
- $PSPACE \subseteq EXP$: TM이 셀을 $n^5$개만큼 사용한다고 하자. 테이프의 모든 가능한 경우의 수는 $\vert T \vert^{n^5} \times \vert Q \vert \times n^5$이다. 만약 시간이 저 경우의 수보다 더 오래 걸린다면, 반드시 반복되는 경우가 존재한다.

$$ P \subseteq NP \subseteq PSPACE \subseteq EXP $$

- $P$와 $EXP$는 다르다. (NFA의 Acceptance 문제는 $EXP$에 풀리지만 $P$에서 안풀린다.) 
- 하지만 나머지 관계에 대해서는 아는 것이 없다.

#### Alternative Definition of NP (Def 2)
기존의 NP의 정의는 NTM이 Polynomial Time에 푸는 문제들의 집합이였다.
새로운 NP의 정의는 다음과 같다.

> 적절한 Hint를 주면 답이 "YES" 인 것을 확인할 수 있는 문제들의 집합
{: .prompt-info}

> $L \in NP$ $\iff$ Language $L' \in P$ such that <br />
- $L'$의 원소는 $(x, h)$이고, $h$는 Polynomial Size 안에 존재하며
- $x \in L \text{ iff } (x, h) \in L'$ for some $h$
{: .prompt-info}

**DTM** $M$이 있다고 하고 입력 $x$에 대한 어떤 hint를 $h(x)$라 하자.
- $x \in L$에 대해서 $M(x, h(x))$의 결과가 Yes (답이 Yes인 경우에는 적당한 어떤 힌트를 주면 Polynomial Time에 알아낼 수 있다.)
- $x \notin L$에 대해서는 $M(x, y)$의 결과가 No (답이 No인 경우에는 어떤 힌트를 주더라도 Yes를 출력하지 않아야 한다.)

이제 $NP$의 첫번째 정의와 두번째 정의가 같은지를 증명해보자. 
1. $L$을 Polynomial 시간 안에 Accept하는 NTM $M$이 존재한다고 가정하자. Hint로 $M$이 Yes로 가는 계산과정이 주어지면 DTM $M'$이 Polynomial 시간 안에 이 문제의 정답이 Yes인 것을 확인할 수 있다.
2. Hint를 주었을 때 DTM $M'$이 Polynomial 시간 안에 정답이 Yes임을 확인할 수 있다고 가정하자. NTM $M$은 모든 가능한 Hint를 동시에 생성해서 Polynomial 시간 안에 문제를 풀 수 있다.

(CHATGPT의 요약)
- Def1 $\rightarrow$ Def2: NTM의 비결정론적 선택을 힌트로 제공하면, DTM이 다항 시간 내에 검증 가능하므로 Def2를 만족한다.
- Def2 $\rightarrow$ Def1: 모든 힌트를 비결정론적으로 추측하는 NTM을 구성하면, 다항 시간 내에 문제를 해결할 수 있으므로 Def1을 만족한다.

####  Basic Problem in Crytography
이제 다시 아래 그림을 보자.

![cry](assets/img/school_cry/cr1-1.png)

- Bob은 Key를 주면 문제가 풀려야 하고, Eve는 Key 없이 문제를 풀어야 한다. 여기서의 Key가 위에서 말한 $NP$의 힌트를 의미한다!
- Bob은 힌트가 있으므로 DTM으로 (결정론적으로) 복호화를 할 수 있다. 즉, Bob의 문제는 $P$에 속한다.
- Eve는 힌트가 없으니 NTM으로 (비결정론적으로) 복호화를 해야 한다. 즉, Eve의 문제는 $NP$에 속한다. ($NP$ 밖으로 나갈 수 없다.)
- 따라서, 메시지 복호화 문제는 $NP$에 속해야 한다!

$NP$ 안에는 있는데 $P$ 안에는 있는지 모르는 문제들이 매우 많다. 만약 $P = NP$ 일 경우, 이런 암호 시스템이 불가능할 수도 있다!

#### NP-Completeness
이왕이면 Eve에게 줄 문제가 $NP$ 내에서도 어려운 문제이면 좋겠다. NP-Complete 문제는 $NP$ 문제 중 가장 어려운 문제를 의미한다.

- 어렵다의 기준: 푸는데 시간이 많이 걸린다는 것을 의미!
- 어떤 문제가 NP-Complete 문제이다. $\iff$ $NP$의 모든 문제가 그 문제로 Reduce 될 수 있다.

이제 문제의 Reduction이 무엇인지에 대해서 알아보자.


### [3.9] Problem Reduction
---
두 문제의 난이도(걸리는 시간)를 비교하는 방법으로 Reduction이 있다.

- 문제 $A$의 input을 $X$, solution을 $Y$ / 문제 $B$의 input을 $X'$, solution을 $Y'$라 하자.
- 문제 A가 문제 B로 Reduce 된다는 말은 $X$를 $X'$로 Transfrom을 하고, 문제 $B$를 푼 뒤 solution인 $Y'$을 Back Transform을 해서 문제 $A$의 solution $Y$를 얻는 것을 의미한다.
- 예시: $A$는 최댓값을 찾는 문제, $B$는 Sorting을 하는 문제라면 $A$ 문제를 풀기 위해 $B$의 입력으로 바꿔서 정렬한 후 그 답에서 최댓값을 역으로 구할 수 있다.

$A$에서 $B$로 문제를 Reduce 하면 **어떤 문제가 더 어렵다**고 할 수 있는 걸까?

- Transform 과정에서 하는 일이 별로 없으면 $B$가 더 어렵다.
- Complexity Theroy에서는 transform 과정에서 Polynomial Time만 쓸 수 있다!
- **따라서, 문제 $A$가 Polynomial-Time 안에 문제 $B$로 Reduce되는 경우, 문제 $B$의 난이도가 같거나 더 어렵다!**

#### Problem SAT (satisfiability)
SAT 문제는 가장 처음으로 알려진 NP-Complete 문제이다. 따라서 $NP$에 있는 모든 문제가 SAT 문제로 Reduce 될 수 있다!

- $(p\ or\ q)\ \text{ and not } p$ : $p = F, q = T$로 답이 정해진다. 따라서 Satisfiable한 명제식이다.
- $p \text{ and not } p$: 충족되는 답이 없으므로 satisfiable하지 않은 명제식이다.

- SAT 문제는 $NP$에 속한다.
  - 적절한 정답(ex. $p = F, q = T$)을 주면 그 답이 Yes인지를 알 수 있으므로 Def2에 의해 $NP$에 속한다.
- SAT 문제는 NP-Complete에 속한다.
  - 모든 $NP$ 문제가 SAT 문제로 Reduce됨을 보이면 된다. S.A. Cook이라는 사람이 이 증명을 해냈다.

#### Proof that SAT is in NP-Complete
1. DTM의 각 시간별 테이프의 모든 상태를 엑셀같은 표에 하나하나 기록한다고 하자.
2. 하나의 셀은 Gate와 같이 Input과 Output으로 구성된다. 
- Input으로는 다음 값들이 들어간다.
  - $h$: Head가 $0$이면 Output이 Input과 동일, Head가 $1$이면 어떤 회로를 돌려서 Output을 만들어냄
  - $q$: Symbol
  - $s$: Status
- Output으로는 왼쪽, 자기자신, 오른쪽 3칸으로 나눠서 $h$, $q$가 나간다.
3. DTM은 모두 Logic Gate가 되기 때문에 커다란 Logic 식 하나로 표현이 가능하다.
4. NTM의 경우는 Choice 입력이 추가로 들어간다. 하나의 Choice 입력이 셀의 한 행마다 다 들어간다. 따라서 NTM도 Logic 식 하나로 표현이 가능하다.

$NP$에 들어있는 문제라면 그 문제를 푸는 NTM $M$이 존재한다. 입력에 대해 Choice를 잘 선택하면 $M$이 Accept 하는 어떤 경우가 존재한다. 즉, $NP$ 문제는 아래와 같이 환원될 수 있다. 
- Choice를 잘 고르면 마지막에 Yes가 나오도록 할 수 있는가?

이 말은 곧 SAT 문제와 의미가 같다. 즉 SAT 문제를 풀 수 있으면 이 문제도 당연히 풀 수 있는 문제가 된다. 따라서 모든 $NP$ 문제는 SAT 문제로 Reduce 된다!


### [3.10] Class $\text{Co-NP}$
---
- $NP$: NTM을 돌려서 하나라도 Yes가 나오면 Yes를 출력하는 문제. 정답이 Yes인 경우에 Hint가 존재한다.
- $\text{Co-NP}$: NTM을 돌려서 하나라도 No가 나오면 No를 출력하는 문제. 정답이 No인 경우에 Hint가 존재한다.
- $L \in NP \iff L^C \in \text{co-NP}$

#### Class $NP \cap \text{Co-NP}$
$NP$와 $\text{co-NP}$가 같은지는 모른다. 
- $P \subseteq NP \cap \text{Co-NP}$ (같은지 아닌지는 모른다.)

다시 암호학의 처음 문제로 돌아와보자.
- 수신자 Bob은 $P$ 안에 있는 문제를 풀고, 공격자 Eve는 $NP$ 문제를 풀게 하는 것이 목표다. 그중에 가장 어려운 문제가 NP-Complete 이므로 Eve가 이 문제를 풀게 하는 것이 좋겠다.
- 소수 판별 문제는 $P$이지만, 소인수분해 문제는 NP-Complete에 속한다. 이를 이용한 암호 시스템을 알아보자.
